@using System.Globalization

<MudCard Outlined="true">

    <MudCardHeader>
        <CardHeaderAvatar>
            <div style="display: flex; flex-direction: column; align-items: center;">
                <MudAvatar Size="Size.Large" Color="Color.Primary" Class="mb-1">
                    @CalendarItem.start.Day
                </MudAvatar>
                <MudText Color="Color.Primary" Typo="Typo.caption" Class="mt-1">
                    @this.GetMonthText()
                </MudText>
            </div>
        </CardHeaderAvatar>

        <CardHeaderContent>
            <MudStack Spacing="2">
                <MudText Typo="Typo.h6" Class="text-truncate">
                    @CalendarItem.training.name
                </MudText>
                <MudText Color="Color.Default" Typo="Typo.body2">
                    <MudIcon Icon="@Icons.Material.Filled.AccessTime" Color="Color.Primary" Size="Size.Small" />
                    @CalendarItem.start.ToString("HH:mm") - @CalendarItem.end?.ToString("HH:mm")
                </MudText>
            </MudStack>
        </CardHeaderContent>
    </MudCardHeader>

    <MudDivider />

    <MudCardContent>
        <MudText>@CalendarItem.training.description</MudText>

        @if(CalendarItem.instructors?.Any() == true)
        {
             <MudList T="InstructorDto" Dense="true" Gutters="false" Class="my-2">
                @foreach (var instructor in CalendarItem.instructors)
                {
                    <MudListItem>
                        <MudIcon Icon="@Icons.Material.Filled.Person"
                                 Size="Size.Small"/>
                        @instructor.fullName
                    </MudListItem>
                }
            </MudList>
        }
    </MudCardContent>

    <MudCardActions>
        <MudButton FullWidth="true"
                   Variant="Variant.Filled"
                   Color="Color.Primary"
                   OnClick="@(async (_) => await OnSelected.InvokeAsync(CalendarItem))">
            Записаться
        </MudButton>
    </MudCardActions>

</MudCard>    
    

@code {
    [Parameter, EditorRequired] public CalendarItemViewModel CalendarItem { get; set; } = default!;
    
    [Parameter] public EventCallback<CalendarItemViewModel> OnSelected { get; set; }

    private String GetMonthText() => CalendarItem.start.ToString("MMM");
}